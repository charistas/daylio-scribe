{
  "version": 3,
  "sources": ["../js/app.ts"],
  "sourcesContent": ["/**\n * Daylio Scribe - A human-friendly editor for Daylio backup notes\n */\n\nimport type { DaylioBackup, DayEntry, CustomMood, Asset, MoodInfo, DateRange, VisibleRange, ToastType } from './types.js';\n\n// Declare external globals (loaded via script tags)\ndeclare const Quill: any;\ndeclare const JSZip: any;\n\n// Highest Daylio backup version tested with this app\nconst SUPPORTED_VERSION = 19;\n\nclass DaylioScribe {\n    // Data\n    private data: DaylioBackup | null = null;\n    private entries: DayEntry[] = [];\n    private filteredEntries: DayEntry[] = [];\n    private currentEntryIndex: number | null = null;\n    private moods: Record<number, MoodInfo> = {};\n    private assetMap: Record<number, Asset> | null = null;\n\n    // Quill editor\n    private quill: any = null;\n    private isUpdating = false;\n    private hasUnsavedChanges = false;\n    private savedSelection: any = null;\n\n    // Original entry states for revert (keyed by entry index)\n    private originalEntryStates: Map<number, { note: string; note_title: string }> = new Map();\n\n    // Calendar state\n    private calendarDate = new Date();\n    private selectedCalendarDate: Date | null = null;\n\n    // Photo gallery state\n    private currentEntryPhotos: string[] = [];\n    private currentPhotoIndex = 0;\n    private lightboxTrigger: HTMLElement | null = null;\n\n    // Virtual scrolling state\n    private itemHeight = 73;\n    private bufferSize = 5;\n    private lastVisibleStart = -1;\n    private lastVisibleEnd = -1;\n    private scrollRAF: number | null = null;\n\n    // Default mood labels\n    private defaultMoodLabels: Record<number, string> = {\n        1: 'great',\n        2: 'good',\n        3: 'meh',\n        4: 'bad',\n        5: 'awful'\n    };\n\n    // ZIP storage\n    private originalZip: any = null;\n    private assets: Record<string, Uint8Array> = {};\n\n    // DOM Elements\n    private toastContainer!: HTMLElement;\n    private dropzone!: HTMLElement;\n    private fileInput!: HTMLInputElement;\n    private app!: HTMLElement;\n    private entryCount!: HTMLElement;\n    private notesCount!: HTMLElement;\n    private backupVersion!: HTMLElement;\n    private filterNotes!: HTMLInputElement;\n    private searchInput!: HTMLInputElement;\n    private dateRangeSelect!: HTMLSelectElement;\n    private customDateRange!: HTMLElement;\n    private dateFrom!: HTMLInputElement;\n    private dateTo!: HTMLInputElement;\n    private entriesList!: HTMLElement;\n    private miniCalendar!: HTMLElement;\n    private calendarTitle!: HTMLElement;\n    private calendarGrid!: HTMLElement;\n    private prevMonthBtn!: HTMLElement;\n    private nextMonthBtn!: HTMLElement;\n    private saveBtn!: HTMLElement;\n    private exportCsvBtn!: HTMLElement;\n    private editorPlaceholder!: HTMLElement;\n    private editor!: HTMLElement;\n    private editorDate!: HTMLElement;\n    private editorMood!: HTMLElement;\n    private noteTitleInput!: HTMLInputElement;\n    private revertBtn!: HTMLButtonElement;\n    private photoSection!: HTMLElement;\n    private photoCount!: HTMLElement;\n    private photoThumbnails!: HTMLElement;\n    private photoLightbox!: HTMLElement;\n    private lightboxImage!: HTMLImageElement;\n    private lightboxCounter!: HTMLElement;\n    private lightboxClose!: HTMLElement;\n    private lightboxPrev!: HTMLElement;\n    private lightboxNext!: HTMLElement;\n    private emojiPickerPopup!: HTMLElement;\n    private emojiPicker!: HTMLElement;\n\n    constructor() {\n        this.initElements();\n        this.initQuill();\n        this.bindEvents();\n        this.initVirtualScroll();\n    }\n\n    private initElements(): void {\n        this.toastContainer = document.getElementById('toastContainer')!;\n        this.dropzone = document.getElementById('dropzone')!;\n        this.fileInput = document.getElementById('fileInput') as HTMLInputElement;\n        this.app = document.getElementById('app')!;\n        this.entryCount = document.getElementById('entryCount')!;\n        this.notesCount = document.getElementById('notesCount')!;\n        this.backupVersion = document.getElementById('backupVersion')!;\n        this.filterNotes = document.getElementById('filterNotes') as HTMLInputElement;\n        this.searchInput = document.getElementById('searchInput') as HTMLInputElement;\n        this.dateRangeSelect = document.getElementById('dateRangeSelect') as HTMLSelectElement;\n        this.customDateRange = document.getElementById('customDateRange')!;\n        this.dateFrom = document.getElementById('dateFrom') as HTMLInputElement;\n        this.dateTo = document.getElementById('dateTo') as HTMLInputElement;\n        this.entriesList = document.getElementById('entriesList')!;\n        this.miniCalendar = document.getElementById('miniCalendar')!;\n        this.calendarTitle = document.getElementById('calendarTitle')!;\n        this.calendarGrid = document.getElementById('calendarGrid')!;\n        this.prevMonthBtn = document.getElementById('prevMonth')!;\n        this.nextMonthBtn = document.getElementById('nextMonth')!;\n        this.saveBtn = document.getElementById('saveBtn')!;\n        this.exportCsvBtn = document.getElementById('exportCsvBtn')!;\n        this.editorPlaceholder = document.getElementById('editorPlaceholder')!;\n        this.editor = document.getElementById('editor')!;\n        this.editorDate = document.getElementById('editorDate')!;\n        this.editorMood = document.getElementById('editorMood')!;\n        this.noteTitleInput = document.getElementById('noteTitleInput') as HTMLInputElement;\n        this.revertBtn = document.getElementById('revertBtn') as HTMLButtonElement;\n        this.photoSection = document.getElementById('photoSection')!;\n        this.photoCount = document.getElementById('photoCount')!;\n        this.photoThumbnails = document.getElementById('photoThumbnails')!;\n        this.photoLightbox = document.getElementById('photoLightbox')!;\n        this.lightboxImage = document.getElementById('lightboxImage') as HTMLImageElement;\n        this.lightboxCounter = document.getElementById('lightboxCounter')!;\n        this.lightboxClose = document.getElementById('lightboxClose')!;\n        this.lightboxPrev = document.getElementById('lightboxPrev')!;\n        this.lightboxNext = document.getElementById('lightboxNext')!;\n    }\n\n    private initQuill(): void {\n        this.quill = new Quill('#noteEditor', {\n            theme: 'snow',\n            placeholder: 'Write your note here...',\n            modules: {\n                toolbar: {\n                    container: [\n                        ['undo', 'redo'],\n                        ['bold', 'italic', 'underline', 'strike'],\n                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n                        ['emoji']\n                    ],\n                    handlers: {\n                        'emoji': () => this.toggleEmojiPicker(),\n                        'undo': () => this.quill.history.undo(),\n                        'redo': () => this.quill.history.redo()\n                    }\n                },\n                keyboard: {\n                    bindings: {\n                        bold: {\n                            key: 'B',\n                            shortKey: true,\n                            handler: function(this: any, _range: any, context: any) {\n                                this.quill.format('bold', !context.format.bold);\n                            }\n                        },\n                        italic: {\n                            key: 'I',\n                            shortKey: true,\n                            handler: function(this: any, _range: any, context: any) {\n                                this.quill.format('italic', !context.format.italic);\n                            }\n                        },\n                        underline: {\n                            key: 'U',\n                            shortKey: true,\n                            handler: function(this: any, _range: any, context: any) {\n                                this.quill.format('underline', !context.format.underline);\n                            }\n                        }\n                    }\n                }\n            }\n        });\n\n        this.quill.on('text-change', (_delta: any, _oldDelta: any, source: string) => {\n            if (!this.isUpdating && source === 'user') {\n                this.updateCurrentEntry();\n            }\n        });\n\n        this.initEmojiPicker();\n    }\n\n    private initEmojiPicker(): void {\n        this.emojiPickerPopup = document.getElementById('emojiPickerPopup')!;\n        this.emojiPicker = document.querySelector('emoji-picker')!;\n\n        // Add aria-labels to custom toolbar buttons\n        setTimeout(() => {\n            const emojiBtn = document.querySelector('.ql-emoji') as HTMLElement;\n            if (emojiBtn) {\n                emojiBtn.setAttribute('aria-label', 'Insert emoji');\n                emojiBtn.setAttribute('title', 'Insert emoji');\n            }\n            const undoBtn = document.querySelector('.ql-undo') as HTMLElement;\n            if (undoBtn) {\n                undoBtn.setAttribute('aria-label', 'Undo');\n                undoBtn.setAttribute('title', 'Undo (Ctrl+Z)');\n            }\n            const redoBtn = document.querySelector('.ql-redo') as HTMLElement;\n            if (redoBtn) {\n                redoBtn.setAttribute('aria-label', 'Redo');\n                redoBtn.setAttribute('title', 'Redo (Ctrl+Shift+Z)');\n            }\n        }, 100);\n\n        this.emojiPicker.addEventListener('emoji-click', (event: any) => {\n            const emoji = event.detail.unicode;\n            this.insertEmoji(emoji);\n            this.hideEmojiPicker();\n        });\n\n        // Close on click outside\n        document.addEventListener('click', (event: MouseEvent) => {\n            if (!this.emojiPickerPopup.classList.contains('hidden')) {\n                const target = event.target as HTMLElement;\n                const isClickInside = this.emojiPickerPopup.contains(target) ||\n                                     target.closest('.ql-emoji');\n                if (!isClickInside) {\n                    this.hideEmojiPicker();\n                }\n            }\n        });\n\n        // Close on Escape key\n        document.addEventListener('keydown', (event: KeyboardEvent) => {\n            if (event.key === 'Escape' && !this.emojiPickerPopup.classList.contains('hidden')) {\n                this.hideEmojiPicker();\n                // Return focus to emoji button\n                const emojiBtn = document.querySelector('.ql-emoji') as HTMLElement;\n                emojiBtn?.focus();\n            }\n        });\n    }\n\n    private toggleEmojiPicker(): void {\n        if (this.emojiPickerPopup.classList.contains('hidden')) {\n            this.showEmojiPicker();\n        } else {\n            this.hideEmojiPicker();\n        }\n    }\n\n    private showEmojiPicker(): void {\n        const emojiButton = document.querySelector('.ql-emoji') as HTMLElement;\n        const rect = emojiButton.getBoundingClientRect();\n\n        this.emojiPickerPopup.style.top = (rect.bottom + 5) + 'px';\n        this.emojiPickerPopup.style.left = rect.left + 'px';\n\n        const pickerWidth = 350;\n        if (rect.left + pickerWidth > window.innerWidth) {\n            this.emojiPickerPopup.style.left = (window.innerWidth - pickerWidth - 10) + 'px';\n        }\n\n        this.emojiPickerPopup.classList.remove('hidden');\n        this.savedSelection = this.quill.getSelection();\n    }\n\n    private hideEmojiPicker(): void {\n        this.emojiPickerPopup.classList.add('hidden');\n    }\n\n    private insertEmoji(emoji: string): void {\n        const range = this.savedSelection || { index: this.quill.getLength() - 1 };\n        this.quill.insertText(range.index, emoji, 'user');\n        this.quill.setSelection(range.index + emoji.length);\n    }\n\n    private bindEvents(): void {\n        this.dropzone.addEventListener('click', () => this.fileInput.click());\n        this.fileInput.addEventListener('change', (e) => {\n            const target = e.target as HTMLInputElement;\n            if (target.files?.[0]) this.handleFile(target.files[0]);\n        });\n\n        this.dropzone.addEventListener('dragover', (e) => {\n            e.preventDefault();\n            this.dropzone.classList.add('dragover');\n        });\n\n        this.dropzone.addEventListener('dragleave', () => {\n            this.dropzone.classList.remove('dragover');\n        });\n\n        this.dropzone.addEventListener('drop', (e) => {\n            e.preventDefault();\n            this.dropzone.classList.remove('dragover');\n            const file = e.dataTransfer?.files[0];\n            if (file) this.handleFile(file);\n        });\n\n        this.filterNotes.addEventListener('change', () => {\n            this.renderCalendar();\n            this.applyFilters();\n        });\n        this.searchInput.addEventListener('input', () => this.applyFilters());\n        this.saveBtn.addEventListener('click', () => this.saveBackup());\n        this.exportCsvBtn.addEventListener('click', () => this.exportCsv());\n\n        this.dateRangeSelect.addEventListener('change', () => {\n            if (this.dateRangeSelect.value === 'custom') {\n                this.customDateRange.classList.remove('hidden');\n            } else {\n                this.customDateRange.classList.add('hidden');\n                this.applyFilters();\n            }\n        });\n        this.dateFrom.addEventListener('change', () => this.applyFilters());\n        this.dateTo.addEventListener('change', () => this.applyFilters());\n\n        this.prevMonthBtn.addEventListener('click', () => {\n            this.calendarDate.setMonth(this.calendarDate.getMonth() - 1);\n            this.renderCalendar();\n        });\n        this.nextMonthBtn.addEventListener('click', () => {\n            this.calendarDate.setMonth(this.calendarDate.getMonth() + 1);\n            this.renderCalendar();\n        });\n\n        this.lightboxClose.addEventListener('click', () => this.closeLightbox());\n        this.lightboxPrev.addEventListener('click', () => this.showPrevPhoto());\n        this.lightboxNext.addEventListener('click', () => this.showNextPhoto());\n        this.photoLightbox.querySelector('.lightbox-overlay')?.addEventListener('click', () => this.closeLightbox());\n\n        document.addEventListener('keydown', (e) => {\n            if (!this.photoLightbox.classList.contains('hidden')) {\n                if (e.key === 'Escape') this.closeLightbox();\n                if (e.key === 'ArrowLeft') this.showPrevPhoto();\n                if (e.key === 'ArrowRight') this.showNextPhoto();\n            }\n        });\n\n        this.noteTitleInput.addEventListener('input', () => this.updateCurrentEntry());\n        this.revertBtn.addEventListener('click', () => this.revertEntry());\n\n        window.addEventListener('beforeunload', (e) => {\n            if (this.hasUnsavedChanges) {\n                e.preventDefault();\n                e.returnValue = '';\n                return '';\n            }\n        });\n    }\n\n    private async handleFile(file: File): Promise<void> {\n        if (!file || !file.name.endsWith('.daylio')) {\n            this.showToast('error', 'Invalid File', 'Please select a .daylio backup file exported from the Daylio app.');\n            return;\n        }\n\n        try {\n            const dropzoneP = this.dropzone.querySelector('p');\n            if (dropzoneP) dropzoneP.textContent = 'Loading...';\n\n            this.originalZip = await JSZip.loadAsync(file);\n\n            this.assets = {};\n            const assetFiles = Object.keys(this.originalZip.files).filter(\n                (name: string) => name.startsWith('assets/') && !this.originalZip.files[name].dir\n            );\n\n            for (const assetPath of assetFiles) {\n                this.assets[assetPath] = await this.originalZip.files[assetPath].async('uint8array');\n            }\n\n            const backupFile = this.originalZip.file('backup.daylio');\n            if (!backupFile) {\n                throw new Error('backup.daylio not found in the archive');\n            }\n\n            const base64Content = await backupFile.async('string');\n            const jsonString = this.base64DecodeUtf8(base64Content.trim());\n            this.data = JSON.parse(jsonString);\n\n            this.validateBackupStructure();\n\n            if (!this.checkVersion()) {\n                if (dropzoneP) dropzoneP.textContent = 'Drop your .daylio backup file here';\n                return;\n            }\n\n            this.entries = this.data!.dayEntries || [];\n            this.storeOriginalEntryStates();\n            this.buildMoodLabels();\n            this.showApp();\n        } catch (err) {\n            this.showToast('error', 'Failed to Load Backup', (err as Error).message);\n            const dropzoneP = this.dropzone.querySelector('p');\n            if (dropzoneP) dropzoneP.textContent = 'Drop your .daylio backup file here';\n        }\n    }\n\n    private checkVersion(): boolean {\n        const backupVersion = this.data?.version;\n\n        if (backupVersion === undefined) {\n            console.warn('Backup has no version field - proceeding anyway');\n            return true;\n        }\n\n        if (backupVersion > SUPPORTED_VERSION) {\n            const proceed = confirm(\n                `Warning: This backup is from a newer Daylio version (v${backupVersion}).\\n\\n` +\n                `This app was tested with version ${SUPPORTED_VERSION}.\\n\\n` +\n                `The backup structure may have changed. Editing could cause data loss or corruption.\\n\\n` +\n                `Do you want to continue anyway?`\n            );\n            if (!proceed) {\n                return false;\n            }\n            console.warn(`Proceeding with unsupported backup version ${backupVersion} (supported: ${SUPPORTED_VERSION})`);\n        }\n\n        return true;\n    }\n\n    private validateBackupStructure(): void {\n        if (!this.data || typeof this.data !== 'object') {\n            throw new Error('Invalid backup: not a valid JSON object');\n        }\n\n        if (!Array.isArray(this.data.dayEntries)) {\n            throw new Error('Invalid backup: missing or invalid dayEntries array');\n        }\n\n        if (!Array.isArray(this.data.customMoods)) {\n            throw new Error('Invalid backup: missing or invalid customMoods array');\n        }\n\n        for (let i = 0; i < Math.min(this.data.dayEntries.length, 5); i++) {\n            const entry = this.data.dayEntries[i];\n            if (typeof entry.datetime !== 'number') {\n                throw new Error(`Invalid backup: entry ${i} missing datetime field`);\n            }\n            if (typeof entry.mood !== 'number') {\n                throw new Error(`Invalid backup: entry ${i} missing mood field`);\n            }\n        }\n    }\n\n    private buildMoodLabels(): void {\n        this.moods = {};\n        const customMoods = this.data?.customMoods || [];\n\n        for (const mood of customMoods) {\n            let label = mood.custom_name?.trim();\n            if (!label) {\n                label = this.defaultMoodLabels[mood.predefined_name_id] || `mood ${mood.id}`;\n            }\n\n            this.moods[mood.id] = {\n                label: label,\n                groupId: mood.mood_group_id\n            };\n        }\n    }\n\n    private storeOriginalEntryStates(): void {\n        this.originalEntryStates.clear();\n        for (let i = 0; i < this.entries.length; i++) {\n            const entry = this.entries[i];\n            this.originalEntryStates.set(i, {\n                note: entry.note || '',\n                note_title: entry.note_title || ''\n            });\n        }\n    }\n\n    private hasAnyChanges(): boolean {\n        for (let i = 0; i < this.entries.length; i++) {\n            const entry = this.entries[i];\n            const original = this.originalEntryStates.get(i);\n            if (!original) continue;\n\n            if (entry.note !== original.note || entry.note_title !== original.note_title) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    private getMoodLabel(moodId: number): string {\n        return this.moods[moodId]?.label || `mood ${moodId}`;\n    }\n\n    private getMoodGroupId(moodId: number): number {\n        return this.moods[moodId]?.groupId || moodId;\n    }\n\n    private showApp(): void {\n        this.dropzone.classList.add('hidden');\n        this.app.classList.remove('hidden');\n\n        const withNotes = this.entries.filter(e => e.note && e.note.length > 0).length;\n        this.entryCount.textContent = `${this.entries.length} entries`;\n        this.notesCount.textContent = `${withNotes} with notes`;\n\n        const version = this.data?.version;\n        if (version !== undefined) {\n            this.backupVersion.textContent = `v${version}`;\n            if (version > SUPPORTED_VERSION) {\n                this.backupVersion.classList.add('version-warning');\n                (this.backupVersion as HTMLElement).dataset.tooltip = `Unsupported version (tested up to v${SUPPORTED_VERSION})`;\n            } else {\n                this.backupVersion.classList.remove('version-warning');\n                (this.backupVersion as HTMLElement).dataset.tooltip = 'Backup format version';\n            }\n        } else {\n            this.backupVersion.textContent = 'v?';\n            (this.backupVersion as HTMLElement).dataset.tooltip = 'Unknown version';\n        }\n\n        this.miniCalendar.classList.add('visible');\n        this.renderCalendar();\n        this.applyFilters();\n    }\n\n    private applyFilters(): void {\n        let filtered = [...this.entries];\n\n        if (this.filterNotes.checked) {\n            filtered = filtered.filter(e => e.note && e.note.length > 0);\n        }\n\n        const dateRange = this.getDateRange();\n        if (dateRange) {\n            filtered = filtered.filter(e => {\n                const entryDate = e.datetime;\n                return entryDate >= dateRange.from && entryDate <= dateRange.to;\n            });\n        }\n\n        const searchTerm = this.searchInput.value.toLowerCase().trim();\n        if (searchTerm) {\n            filtered = filtered.filter(e => {\n                const noteText = this.htmlToPlainText(e.note || '').toLowerCase();\n                const titleText = (e.note_title || '').toLowerCase();\n                return noteText.includes(searchTerm) || titleText.includes(searchTerm);\n            });\n        }\n\n        filtered.sort((a, b) => b.datetime - a.datetime);\n\n        this.filteredEntries = filtered;\n        this.renderEntries();\n    }\n\n    private getDateRange(): DateRange | null {\n        const selection = this.dateRangeSelect.value;\n        const now = new Date();\n        let from: Date, to: Date;\n\n        switch (selection) {\n            case 'all':\n                return null;\n\n            case 'thisMonth':\n                from = new Date(now.getFullYear(), now.getMonth(), 1);\n                to = new Date(now.getFullYear(), now.getMonth() + 1, 0, 23, 59, 59, 999);\n                break;\n\n            case 'last30':\n                from = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n                to = now;\n                break;\n\n            case 'last3Months':\n                from = new Date(now.getFullYear(), now.getMonth() - 2, 1);\n                to = now;\n                break;\n\n            case 'thisYear':\n                from = new Date(now.getFullYear(), 0, 1);\n                to = new Date(now.getFullYear(), 11, 31, 23, 59, 59, 999);\n                break;\n\n            case 'lastYear':\n                from = new Date(now.getFullYear() - 1, 0, 1);\n                to = new Date(now.getFullYear() - 1, 11, 31, 23, 59, 59, 999);\n                break;\n\n            case 'custom': {\n                const fromVal = this.dateFrom.value;\n                const toVal = this.dateTo.value;\n                if (!fromVal && !toVal) return null;\n                from = fromVal ? new Date(fromVal + 'T00:00:00') : new Date(0);\n                to = toVal ? new Date(toVal + 'T23:59:59.999') : now;\n                break;\n            }\n\n            default:\n                return null;\n        }\n\n        return { from: from.getTime(), to: to.getTime() };\n    }\n\n    private renderCalendar(): void {\n        const year = this.calendarDate.getFullYear();\n        const month = this.calendarDate.getMonth();\n\n        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',\n                           'July', 'August', 'September', 'October', 'November', 'December'];\n        this.calendarTitle.textContent = `${monthNames[month]} ${year}`;\n\n        const entriesMap = this.buildEntriesMap();\n\n        const firstDay = new Date(year, month, 1);\n        const lastDay = new Date(year, month + 1, 0);\n        const totalDays = lastDay.getDate();\n\n        let startDay = firstDay.getDay() - 1;\n        if (startDay < 0) startDay = 6;\n\n        const today = new Date();\n        const isCurrentMonth = today.getFullYear() === year && today.getMonth() === month;\n\n        this.calendarGrid.innerHTML = '';\n\n        for (let i = 0; i < startDay; i++) {\n            const prevMonthDay = new Date(year, month, -startDay + i + 1);\n            this.calendarGrid.appendChild(this.createDayCell(prevMonthDay, entriesMap, true));\n        }\n\n        for (let day = 1; day <= totalDays; day++) {\n            const date = new Date(year, month, day);\n            const isToday = isCurrentMonth && day === today.getDate();\n            this.calendarGrid.appendChild(this.createDayCell(date, entriesMap, false, isToday));\n        }\n\n        const cellsUsed = startDay + totalDays;\n        const cellsNeeded = Math.ceil(cellsUsed / 7) * 7;\n        for (let i = 0; i < cellsNeeded - cellsUsed; i++) {\n            const nextMonthDay = new Date(year, month + 1, i + 1);\n            this.calendarGrid.appendChild(this.createDayCell(nextMonthDay, entriesMap, true));\n        }\n    }\n\n    private createDayCell(date: Date, entriesMap: Record<string, DayEntry[]>, isOtherMonth: boolean, isToday = false): HTMLElement {\n        const cell = document.createElement('div');\n        cell.className = 'calendar-day';\n        cell.textContent = String(date.getDate());\n\n        // Accessibility: role and full date label\n        cell.setAttribute('role', 'button');\n        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',\n                           'July', 'August', 'September', 'October', 'November', 'December'];\n        const fullDate = `${monthNames[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;\n\n        if (isOtherMonth) {\n            cell.classList.add('other-month');\n        }\n\n        if (isToday) {\n            cell.classList.add('today');\n        }\n\n        const isSelected = this.selectedCalendarDate &&\n            date.getFullYear() === this.selectedCalendarDate.getFullYear() &&\n            date.getMonth() === this.selectedCalendarDate.getMonth() &&\n            date.getDate() === this.selectedCalendarDate.getDate();\n\n        if (isSelected) {\n            cell.classList.add('selected');\n            cell.setAttribute('aria-pressed', 'true');\n        } else {\n            cell.setAttribute('aria-pressed', 'false');\n        }\n\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const cellDate = new Date(date);\n        cellDate.setHours(0, 0, 0, 0);\n        const isFuture = cellDate > today;\n\n        if (isFuture) {\n            cell.classList.add('future');\n            cell.setAttribute('aria-disabled', 'true');\n            cell.setAttribute('aria-label', `${fullDate}, future date`);\n            return cell;\n        }\n\n        // Make clickable days focusable\n        cell.setAttribute('tabindex', '0');\n\n        const dateKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;\n        const dayEntries = entriesMap[dateKey];\n        let ariaLabel = fullDate;\n\n        if (dayEntries && dayEntries.length > 0) {\n            cell.classList.add('has-entry');\n            const moodGroupId = this.getMoodGroupId(dayEntries[0].mood);\n            const moodColors: Record<number, string> = {\n                1: '#4ecca3',\n                2: '#7ed957',\n                3: '#ffd93d',\n                4: '#ff8c42',\n                5: '#e94560'\n            };\n            cell.style.setProperty('--mood-color', moodColors[moodGroupId] || '#a0a0a0');\n            ariaLabel += `, ${dayEntries.length} ${dayEntries.length === 1 ? 'entry' : 'entries'}`;\n        }\n\n        if (isToday) ariaLabel += ', today';\n        if (isSelected) ariaLabel += ', selected';\n\n        cell.setAttribute('aria-label', ariaLabel);\n\n        cell.addEventListener('click', () => this.handleCalendarDayClick(date));\n        cell.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                this.handleCalendarDayClick(date);\n            }\n        });\n\n        return cell;\n    }\n\n    private buildEntriesMap(): Record<string, DayEntry[]> {\n        const map: Record<string, DayEntry[]> = {};\n        const notesOnly = this.filterNotes.checked;\n\n        for (const entry of this.entries) {\n            if (notesOnly && (!entry.note || entry.note.length === 0)) {\n                continue;\n            }\n\n            const date = new Date(entry.datetime);\n            const key = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;\n            if (!map[key]) map[key] = [];\n            map[key].push(entry);\n        }\n        return map;\n    }\n\n    private handleCalendarDayClick(date: Date): void {\n        if (this.selectedCalendarDate &&\n            date.getFullYear() === this.selectedCalendarDate.getFullYear() &&\n            date.getMonth() === this.selectedCalendarDate.getMonth() &&\n            date.getDate() === this.selectedCalendarDate.getDate()) {\n            this.selectedCalendarDate = null;\n            this.dateRangeSelect.value = 'all';\n            this.customDateRange.classList.add('hidden');\n        } else {\n            this.selectedCalendarDate = date;\n            this.dateRangeSelect.value = 'custom';\n            this.customDateRange.classList.remove('hidden');\n\n            const dateStr = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;\n            this.dateFrom.value = dateStr;\n            this.dateTo.value = dateStr;\n        }\n\n        this.renderCalendar();\n        this.applyFilters();\n    }\n\n    private initVirtualScroll(): void {\n        this.entriesList.addEventListener('scroll', () => this.handleScroll());\n\n        // Accessibility: Set up listbox role\n        this.entriesList.setAttribute('role', 'listbox');\n        this.entriesList.setAttribute('aria-label', 'Journal entries');\n\n        // Keyboard navigation for entry list\n        this.entriesList.addEventListener('keydown', (e) => this.handleEntryListKeydown(e));\n    }\n\n    private handleEntryListKeydown(e: KeyboardEvent): void {\n        const focusedEl = document.activeElement as HTMLElement;\n        if (!focusedEl?.classList.contains('entry-item')) return;\n\n        const currentIndex = parseInt(focusedEl.dataset.virtualIndex || '0');\n        let nextIndex: number | null = null;\n\n        switch (e.key) {\n            case 'ArrowDown':\n                e.preventDefault();\n                nextIndex = Math.min(currentIndex + 1, this.filteredEntries.length - 1);\n                break;\n            case 'ArrowUp':\n                e.preventDefault();\n                nextIndex = Math.max(currentIndex - 1, 0);\n                break;\n            case 'Enter':\n            case ' ':\n                e.preventDefault();\n                const originalIndex = parseInt(focusedEl.dataset.index || '0');\n                this.selectEntry(originalIndex);\n                return;\n            case 'Home':\n                e.preventDefault();\n                nextIndex = 0;\n                break;\n            case 'End':\n                e.preventDefault();\n                nextIndex = this.filteredEntries.length - 1;\n                break;\n            default:\n                return;\n        }\n\n        if (nextIndex !== null && nextIndex !== currentIndex) {\n            this.scrollToEntry(nextIndex);\n            // Focus the new entry after scroll/render\n            requestAnimationFrame(() => {\n                const nextEl = this.entriesList.querySelector(`.entry-item[data-virtual-index=\"${nextIndex}\"]`) as HTMLElement;\n                nextEl?.focus();\n            });\n        }\n    }\n\n    private scrollToEntry(virtualIndex: number): void {\n        const targetScrollTop = virtualIndex * this.itemHeight;\n        const containerHeight = this.entriesList.clientHeight;\n        const currentScrollTop = this.entriesList.scrollTop;\n\n        // Scroll if the target is outside visible area\n        if (targetScrollTop < currentScrollTop) {\n            this.entriesList.scrollTop = targetScrollTop;\n        } else if (targetScrollTop + this.itemHeight > currentScrollTop + containerHeight) {\n            this.entriesList.scrollTop = targetScrollTop - containerHeight + this.itemHeight;\n        }\n    }\n\n    private handleScroll(): void {\n        if (this.scrollRAF) return;\n\n        this.scrollRAF = requestAnimationFrame(() => {\n            this.scrollRAF = null;\n            this.renderVirtualEntries(false);\n        });\n    }\n\n    private calculateVisibleRange(): VisibleRange {\n        const scrollTop = this.entriesList.scrollTop;\n        const containerHeight = this.entriesList.clientHeight;\n        const totalItems = this.filteredEntries.length;\n\n        const visibleStart = Math.floor(scrollTop / this.itemHeight);\n        const visibleCount = Math.ceil(containerHeight / this.itemHeight);\n        const visibleEnd = Math.min(visibleStart + visibleCount, totalItems);\n\n        const bufferedStart = Math.max(0, visibleStart - this.bufferSize);\n        const bufferedEnd = Math.min(totalItems, visibleEnd + this.bufferSize);\n\n        return { bufferedStart, bufferedEnd, totalItems };\n    }\n\n    private renderVirtualEntries(forceRender = true): void {\n        const { bufferedStart, bufferedEnd, totalItems } = this.calculateVisibleRange();\n\n        if (!forceRender &&\n            bufferedStart === this.lastVisibleStart &&\n            bufferedEnd === this.lastVisibleEnd) {\n            return;\n        }\n\n        this.lastVisibleStart = bufferedStart;\n        this.lastVisibleEnd = bufferedEnd;\n\n        const searchTerm = this.searchInput.value.trim();\n        const fragment = document.createDocumentFragment();\n\n        if (bufferedStart > 0) {\n            const topSpacer = document.createElement('div');\n            topSpacer.className = 'virtual-spacer';\n            topSpacer.style.height = `${bufferedStart * this.itemHeight}px`;\n            fragment.appendChild(topSpacer);\n        }\n\n        for (let i = bufferedStart; i < bufferedEnd; i++) {\n            const entry = this.filteredEntries[i];\n            const originalIndex = this.entries.indexOf(entry);\n            const div = document.createElement('div');\n            div.className = 'entry-item';\n            div.dataset.index = String(originalIndex);\n            div.dataset.virtualIndex = String(i);\n\n            // Accessibility attributes\n            div.setAttribute('role', 'option');\n            div.setAttribute('tabindex', '0');\n\n            const isActive = originalIndex === this.currentEntryIndex;\n            if (isActive) {\n                div.classList.add('active');\n                div.setAttribute('aria-selected', 'true');\n            } else {\n                div.setAttribute('aria-selected', 'false');\n            }\n\n            const date = this.formatDate(entry);\n            const preview = this.getPreview(entry, searchTerm);\n            const moodGroupId = this.getMoodGroupId(entry.mood);\n            const moodClass = `mood-${moodGroupId}`;\n            const moodLabel = this.getMoodLabel(entry.mood);\n\n            // Build accessible label\n            const plainPreview = this.htmlToPlainText(entry.note || '').substring(0, 50);\n            const ariaLabel = `${date}, ${moodLabel}${plainPreview ? ', ' + plainPreview : ''}`;\n            div.setAttribute('aria-label', ariaLabel);\n\n            const hasContent = entry.note_title?.trim() || entry.note;\n            const hasPhotos = entry.assets && entry.assets.length > 0;\n            const photoIcon = hasPhotos ? '<span class=\"photo-icon\" aria-hidden=\"true\">\uD83D\uDCF7</span>' : '';\n            const photoSrText = hasPhotos ? '<span class=\"sr-only\">, has photos</span>' : '';\n\n            div.innerHTML = `\n                <div class=\"entry-header\">\n                    <span class=\"entry-date\">${date}</span>\n                    ${photoIcon}${photoSrText}\n                    <span class=\"mood-badge ${moodClass}\">${moodLabel}</span>\n                </div>\n                <div class=\"${hasContent ? 'entry-preview' : 'entry-no-note'}\">${preview}</div>\n            `;\n\n            div.addEventListener('click', () => this.selectEntry(originalIndex));\n            fragment.appendChild(div);\n        }\n\n        const remainingItems = totalItems - bufferedEnd;\n        if (remainingItems > 0) {\n            const bottomSpacer = document.createElement('div');\n            bottomSpacer.className = 'virtual-spacer';\n            bottomSpacer.style.height = `${remainingItems * this.itemHeight}px`;\n            fragment.appendChild(bottomSpacer);\n        }\n\n        this.entriesList.innerHTML = '';\n        this.entriesList.appendChild(fragment);\n    }\n\n    private renderEntries(): void {\n        this.lastVisibleStart = -1;\n        this.lastVisibleEnd = -1;\n        this.entriesList.scrollTop = 0;\n        this.renderVirtualEntries(true);\n    }\n\n    private formatDate(entry: DayEntry): string {\n        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',\n                       'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n        return `${months[entry.month]} ${entry.day}, ${entry.year}`;\n    }\n\n    private getPreview(entry: DayEntry, searchTerm = ''): string {\n        const hasNote = entry.note && entry.note.length > 0;\n        const hasTitle = entry.note_title && entry.note_title.trim();\n\n        if (!hasTitle && !hasNote) {\n            return this.escapeHtml('No note');\n        }\n\n        if (searchTerm && hasNote) {\n            const plain = this.htmlToPlainText(entry.note);\n            const lowerPlain = plain.toLowerCase();\n            const lowerTerm = searchTerm.toLowerCase();\n            const matchIndex = lowerPlain.indexOf(lowerTerm);\n\n            if (matchIndex !== -1) {\n                const snippetLength = 60;\n                const termLength = searchTerm.length;\n\n                let start = Math.max(0, matchIndex - Math.floor((snippetLength - termLength) / 2));\n                let end = Math.min(plain.length, start + snippetLength);\n\n                if (end === plain.length) {\n                    start = Math.max(0, end - snippetLength);\n                }\n\n                let snippet = plain.substring(start, end);\n\n                if (start > 0) snippet = '...' + snippet;\n                if (end < plain.length) snippet = snippet + '...';\n\n                return this.highlightText(snippet, searchTerm);\n            }\n        }\n\n        let text: string;\n        if (hasTitle) {\n            text = entry.note_title!.trim();\n        } else {\n            const plain = this.htmlToPlainText(entry.note);\n            text = plain.length > 60 ? plain.substring(0, 60) + '...' : plain;\n        }\n\n        return this.highlightText(text, searchTerm);\n    }\n\n    private selectEntry(index: number): void {\n        this.currentEntryIndex = index;\n        const entry = this.entries[index];\n\n        this.editorPlaceholder.classList.add('hidden');\n        this.editor.classList.remove('hidden');\n\n        this.editorDate.textContent = this.formatDate(entry);\n        this.editorMood.textContent = this.getMoodLabel(entry.mood);\n        this.editorMood.className = `mood-badge mood-${this.getMoodGroupId(entry.mood)}`;\n\n        this.noteTitleInput.value = entry.note_title || '';\n\n        const cleanHtml = this.daylioToQuillHtml(entry.note || '');\n        const delta = this.quill.clipboard.convert({ html: cleanHtml });\n        this.quill.setContents(delta, 'silent');\n\n        // Clear Quill history for new entry\n        this.quill.history.clear();\n\n        // Hide revert button for fresh entry\n        this.revertBtn.classList.add('hidden');\n\n        document.querySelectorAll('.entry-item').forEach(el => {\n            const htmlEl = el as HTMLElement;\n            el.classList.toggle('active', parseInt(htmlEl.dataset.index || '') === index);\n        });\n\n        this.renderPhotos(entry);\n    }\n\n    private renderPhotos(entry: DayEntry): void {\n        this.currentEntryPhotos.forEach(url => URL.revokeObjectURL(url));\n        this.photoThumbnails.innerHTML = '';\n        this.currentEntryPhotos = [];\n\n        const entryAssetIds = entry.assets || [];\n        if (entryAssetIds.length === 0) {\n            this.photoSection.classList.add('hidden');\n            return;\n        }\n\n        if (!this.assetMap) {\n            this.assetMap = {};\n            (this.data?.assets || []).forEach(asset => {\n                this.assetMap![asset.id] = asset;\n            });\n        }\n\n        entryAssetIds.forEach((assetId, index) => {\n            const asset = this.assetMap![assetId];\n            if (!asset) return;\n\n            const createdAt = new Date(asset.createdAt);\n            const year = createdAt.getFullYear();\n            const month = createdAt.getMonth() + 1;\n            const assetPath = `assets/photos/${year}/${month}/${asset.checksum}`;\n            const assetData = this.assets[assetPath];\n\n            if (assetData) {\n                const url = this.createImageUrl(assetData);\n                this.currentEntryPhotos.push(url);\n\n                const thumb = document.createElement('div');\n                thumb.className = 'photo-thumbnail';\n                thumb.innerHTML = `<img src=\"${url}\" alt=\"Photo ${index + 1}\">`;\n                thumb.addEventListener('click', () => this.openLightbox(this.currentEntryPhotos.length - 1));\n                this.photoThumbnails.appendChild(thumb);\n            }\n        });\n\n        if (this.currentEntryPhotos.length > 0) {\n            this.photoSection.classList.remove('hidden');\n            this.photoCount.textContent = String(this.currentEntryPhotos.length);\n        } else {\n            this.photoSection.classList.add('hidden');\n        }\n    }\n\n    private createImageUrl(data: Uint8Array): string {\n        let mimeType = 'image/jpeg';\n        if (data[0] === 0x89 && data[1] === 0x50) {\n            mimeType = 'image/png';\n        } else if (data[0] === 0x47 && data[1] === 0x49) {\n            mimeType = 'image/gif';\n        }\n\n        const blob = new Blob([data], { type: mimeType });\n        return URL.createObjectURL(blob);\n    }\n\n    private openLightbox(index: number): void {\n        if (this.currentEntryPhotos.length === 0) return;\n\n        // Save trigger for focus return\n        this.lightboxTrigger = document.activeElement as HTMLElement;\n\n        this.currentPhotoIndex = index;\n        this.updateLightboxImage();\n        this.photoLightbox.classList.remove('hidden');\n        document.body.style.overflow = 'hidden';\n\n        // Focus close button for accessibility\n        this.lightboxClose.focus();\n\n        // Add focus trap\n        this.photoLightbox.addEventListener('keydown', this.handleLightboxKeydown);\n    }\n\n    private handleLightboxKeydown = (e: KeyboardEvent): void => {\n        if (e.key === 'Tab') {\n            const focusableEls = this.photoLightbox.querySelectorAll(\n                'button:not([disabled]), [tabindex]:not([tabindex=\"-1\"])'\n            ) as NodeListOf<HTMLElement>;\n\n            const firstEl = focusableEls[0];\n            const lastEl = focusableEls[focusableEls.length - 1];\n\n            if (e.shiftKey && document.activeElement === firstEl) {\n                e.preventDefault();\n                lastEl.focus();\n            } else if (!e.shiftKey && document.activeElement === lastEl) {\n                e.preventDefault();\n                firstEl.focus();\n            }\n        }\n    };\n\n    private closeLightbox(): void {\n        this.photoLightbox.classList.add('hidden');\n        document.body.style.overflow = '';\n\n        // Remove focus trap\n        this.photoLightbox.removeEventListener('keydown', this.handleLightboxKeydown);\n\n        // Return focus to trigger element\n        if (this.lightboxTrigger) {\n            this.lightboxTrigger.focus();\n            this.lightboxTrigger = null;\n        }\n    }\n\n    private showPrevPhoto(): void {\n        if (this.currentEntryPhotos.length === 0) return;\n        this.currentPhotoIndex = (this.currentPhotoIndex - 1 + this.currentEntryPhotos.length) % this.currentEntryPhotos.length;\n        this.updateLightboxImage();\n    }\n\n    private showNextPhoto(): void {\n        if (this.currentEntryPhotos.length === 0) return;\n        this.currentPhotoIndex = (this.currentPhotoIndex + 1) % this.currentEntryPhotos.length;\n        this.updateLightboxImage();\n    }\n\n    private updateLightboxImage(): void {\n        this.lightboxImage.src = this.currentEntryPhotos[this.currentPhotoIndex];\n        this.lightboxCounter.textContent = `${this.currentPhotoIndex + 1} / ${this.currentEntryPhotos.length}`;\n\n        const hasMultiple = this.currentEntryPhotos.length > 1;\n        this.lightboxPrev.style.display = hasMultiple ? '' : 'none';\n        this.lightboxNext.style.display = hasMultiple ? '' : 'none';\n    }\n\n    private updateCurrentEntry(): void {\n        if (this.currentEntryIndex === null) return;\n\n        const entry = this.entries[this.currentEntryIndex];\n        entry.note_title = this.noteTitleInput.value;\n\n        const quillHtml = this.quill.root.innerHTML;\n        entry.note = this.quillToDaylioHtml(quillHtml);\n\n        this.markUnsavedChanges();\n        this.updateEntryPreview(this.currentEntryIndex);\n\n        // Show revert button if entry differs from original\n        const original = this.originalEntryStates.get(this.currentEntryIndex);\n        if (original) {\n            const hasChanges = entry.note !== original.note ||\n                              entry.note_title !== original.note_title;\n            this.revertBtn.classList.toggle('hidden', !hasChanges);\n        }\n    }\n\n    private revertEntry(): void {\n        if (this.currentEntryIndex === null) return;\n\n        const original = this.originalEntryStates.get(this.currentEntryIndex);\n        if (!original) return;\n\n        const entry = this.entries[this.currentEntryIndex];\n\n        // Restore original values\n        entry.note = original.note;\n        entry.note_title = original.note_title;\n\n        // Update UI\n        this.noteTitleInput.value = entry.note_title;\n        const cleanHtml = this.daylioToQuillHtml(entry.note);\n        const delta = this.quill.clipboard.convert({ html: cleanHtml });\n        this.quill.setContents(delta, 'silent');\n        this.quill.history.clear();\n\n        // Update entry preview in list\n        this.updateEntryPreview(this.currentEntryIndex);\n\n        // Hide revert button\n        this.revertBtn.classList.add('hidden');\n\n        // Update unsaved changes indicator\n        if (!this.hasAnyChanges()) {\n            this.clearUnsavedChanges();\n        }\n\n        this.showToast('info', 'Entry Reverted', 'Entry restored to its original state.');\n    }\n\n    private updateEntryPreview(originalIndex: number): void {\n        const entryEl = this.entriesList.querySelector(`.entry-item[data-index=\"${originalIndex}\"]`);\n        if (!entryEl) return;\n\n        const entry = this.entries[originalIndex];\n        const searchTerm = this.searchInput.value.trim();\n        const preview = this.getPreview(entry, searchTerm);\n        const hasContent = entry.note_title?.trim() || entry.note;\n\n        const previewEl = entryEl.querySelector('.entry-preview, .entry-no-note');\n        if (previewEl) {\n            previewEl.className = hasContent ? 'entry-preview' : 'entry-no-note';\n            previewEl.innerHTML = preview;\n        }\n    }\n\n    private markUnsavedChanges(): void {\n        if (!this.hasUnsavedChanges) {\n            this.hasUnsavedChanges = true;\n            this.saveBtn.classList.add('has-changes');\n            this.saveBtn.textContent = 'Download Backup *';\n        }\n    }\n\n    private clearUnsavedChanges(): void {\n        this.hasUnsavedChanges = false;\n        this.saveBtn.classList.remove('has-changes');\n        this.saveBtn.textContent = 'Download Backup';\n    }\n\n    // HTML conversion methods (duplicated from conversions.ts for class use)\n    private daylioToQuillHtml(html: string): string {\n        if (!html) return '';\n\n        let result = html;\n        result = result.replace(/<span[^>]*>/gi, '');\n        result = result.replace(/<\\/span>/gi, '');\n        result = result.replace(/<p[^>]*>/gi, '<p>');\n        result = result.replace(/<li([^>]*)>/gi, (_match: string, attrs: string) => {\n            const dataListMatch = attrs.match(/data-list=\"([^\"]*)\"/);\n            if (dataListMatch) {\n                return `<li data-list=\"${dataListMatch[1]}\">`;\n            }\n            return '<li>';\n        });\n        result = result.replace(/<div><br\\s*\\/?><\\/div>/gi, '<p><br></p>');\n        result = result.replace(/<div>/gi, '<p>');\n        result = result.replace(/<\\/div>/gi, '</p>');\n        result = result.replace(/\\\\n/g, '<br>');\n        result = result.replace(/<b>/gi, '<strong>');\n        result = result.replace(/<\\/b>/gi, '</strong>');\n        result = result.replace(/<i>/gi, '<em>');\n        result = result.replace(/<\\/i>/gi, '</em>');\n        result = result.replace(/<strike>/gi, '<s>');\n        result = result.replace(/<\\/strike>/gi, '</s>');\n        result = result.replace(/<font[^>]*>/gi, '');\n        result = result.replace(/<\\/font>/gi, '');\n        result = this.convertBrToQuillParagraphs(result);\n        result = result.replace(/^(<p><br><\\/p>)+/, '');\n        result = this.addQuillListAttributes(result);\n\n        return result;\n    }\n\n    private convertBrToQuillParagraphs(html: string): string {\n        if (!html) return html;\n\n        let result = html;\n        const BLANK_LINE_PLACEHOLDER = '___BLANK_LINE_PLACEHOLDER___';\n        result = result.replace(/<p><br\\s*\\/?><\\/p>/gi, BLANK_LINE_PLACEHOLDER);\n        const BR_PLACEHOLDER = '___BR_PLACEHOLDER___';\n        result = result.replace(/<br\\s*\\/?>\\s*<br\\s*\\/?>/gi, `</p><p>${BR_PLACEHOLDER}</p><p>`);\n        result = result.replace(/<br\\s*\\/?>/gi, '</p><p>');\n        result = result.replace(new RegExp(BR_PLACEHOLDER, 'g'), '<br>');\n        result = result.replace(new RegExp(BLANK_LINE_PLACEHOLDER, 'g'), '<p><br></p>');\n\n        if (result && !result.startsWith('<')) {\n            const firstTagMatch = result.match(/<[^>]+>/);\n            if (firstTagMatch) {\n                const firstTagIndex = result.indexOf(firstTagMatch[0]);\n                const leadingText = result.substring(0, firstTagIndex);\n                const rest = result.substring(firstTagIndex);\n                if (leadingText.trim()) {\n                    result = `<p>${leadingText}</p>${rest}`;\n                }\n            } else {\n                result = `<p>${result}</p>`;\n            }\n        }\n\n        result = result.replace(/<\\/p>\\s*<\\/p>/gi, '</p>');\n        result = result.replace(/<p>\\s*<p>/gi, '<p>');\n        result = result.replace(/<p><\\/p>/g, '');\n\n        return result;\n    }\n\n    private addQuillListAttributes(html: string): string {\n        if (!html) return html;\n\n        const parser = new DOMParser();\n        const doc = parser.parseFromString('<div>' + html + '</div>', 'text/html');\n        const container = doc.body.firstChild as HTMLElement;\n\n        container.querySelectorAll('ol > li').forEach(li => {\n            if (!li.getAttribute('data-list')) {\n                li.setAttribute('data-list', 'ordered');\n            }\n        });\n\n        container.querySelectorAll('ul > li').forEach(li => {\n            if (!li.getAttribute('data-list')) {\n                li.setAttribute('data-list', 'bullet');\n            }\n        });\n\n        return container.innerHTML;\n    }\n\n    private quillToDaylioHtml(html: string): string {\n        if (!html || html === '<p><br></p>') return '';\n\n        let result = html;\n        result = result.replace(/<span class=\"ql-ui\"[^>]*>.*?<\\/span>/gi, '');\n        result = result.replace(/<ol>(\\s*<li data-list=\"bullet\">)/gi, '<ul><li>');\n        result = result.replace(/<li data-list=\"bullet\">/gi, '<li>');\n        result = result.replace(/<\\/li>(\\s*)<\\/ol>/gi, (match: string, space: string, offset: number) => {\n            const before = result.substring(0, offset);\n            if (before.lastIndexOf('<ul>') > before.lastIndexOf('<ol>')) {\n                return '</li>' + space + '</ul>';\n            }\n            return match;\n        });\n        result = this.convertQuillLists(result);\n        result = result.replace(/<strong>/gi, '<b>');\n        result = result.replace(/<\\/strong>/gi, '</b>');\n        result = result.replace(/<em>/gi, '<i>');\n        result = result.replace(/<\\/em>/gi, '</i>');\n        result = result.replace(/<p>/gi, '<div>');\n        result = result.replace(/<\\/p>/gi, '</div>');\n        result = result.replace(/<div><\\/div>/gi, '<div><br></div>');\n        result = result.replace(/(<div><br><\\/div>)+$/, '');\n        result = result.trim();\n\n        return result;\n    }\n\n    private convertQuillLists(html: string): string {\n        const parser = new DOMParser();\n        const doc = parser.parseFromString('<div>' + html + '</div>', 'text/html');\n        const container = doc.body.firstChild as HTMLElement;\n\n        const ols = container.querySelectorAll('ol');\n        ols.forEach(ol => {\n            const items = ol.querySelectorAll('li');\n            if (items.length > 0) {\n                const firstItem = items[0];\n                const listType = firstItem.getAttribute('data-list');\n\n                if (listType === 'bullet') {\n                    const ul = doc.createElement('ul');\n                    items.forEach(li => {\n                        li.removeAttribute('data-list');\n                        ul.appendChild(li.cloneNode(true));\n                    });\n                    ol.parentNode?.replaceChild(ul, ol);\n                } else {\n                    items.forEach(li => {\n                        li.setAttribute('data-list', 'ordered');\n                    });\n                }\n            }\n        });\n\n        return container.innerHTML;\n    }\n\n    private htmlToPlainText(html: string): string {\n        if (!html) return '';\n\n        let text = html;\n        text = text.replace(/<br\\s*\\/?>/gi, '\\n');\n        text = text.replace(/<\\/div>\\s*<div>/gi, '\\n');\n        text = text.replace(/<\\/(div|p|li)>/gi, '\\n');\n        text = text.replace(/<li[^>]*>/gi, '\u2022 ');\n        text = text.replace(/<[^>]+>/g, '');\n        text = text.replace(/&nbsp;/g, ' ');\n        text = text.replace(/&amp;/g, '&');\n        text = text.replace(/&lt;/g, '<');\n        text = text.replace(/&gt;/g, '>');\n        text = text.replace(/&quot;/g, '\"');\n        text = text.replace(/&#39;/g, \"'\");\n        text = text.replace(/\\\\n/g, '\\n');\n        text = text.replace(/\\n{3,}/g, '\\n\\n');\n        text = text.trim();\n\n        return text;\n    }\n\n    private showToast(type: ToastType, title: string, message = '', duration = 5000): HTMLElement {\n        const icons: Record<ToastType, string> = {\n            error: '\u2715',\n            success: '\u2713',\n            warning: '\u26A0',\n            info: '\u2139'\n        };\n\n        const toast = document.createElement('div');\n        toast.className = `toast toast-${type}`;\n        toast.innerHTML = `\n            <span class=\"toast-icon\">${icons[type] || icons.info}</span>\n            <div class=\"toast-content\">\n                <div class=\"toast-title\">${this.escapeHtml(title)}</div>\n                ${message ? `<div class=\"toast-message\">${this.escapeHtml(message)}</div>` : ''}\n            </div>\n            <button class=\"toast-close\" aria-label=\"Close\">\u00D7</button>\n        `;\n\n        const closeBtn = toast.querySelector('.toast-close');\n        closeBtn?.addEventListener('click', () => this.dismissToast(toast));\n\n        this.toastContainer.appendChild(toast);\n\n        if (duration > 0) {\n            setTimeout(() => this.dismissToast(toast), duration);\n        }\n\n        return toast;\n    }\n\n    private dismissToast(toast: HTMLElement): void {\n        if (!toast || !toast.parentNode) return;\n\n        toast.classList.add('toast-out');\n        toast.addEventListener('animationend', () => {\n            if (toast.parentNode) {\n                toast.parentNode.removeChild(toast);\n            }\n        });\n    }\n\n    private escapeHtml(text: string): string {\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n\n    private highlightText(text: string, searchTerm: string): string {\n        if (!searchTerm || !text) return this.escapeHtml(text);\n\n        const escaped = this.escapeHtml(text);\n        const escapedTerm = this.escapeHtml(searchTerm);\n\n        const regexSafe = escapedTerm.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        const regex = new RegExp(`(${regexSafe})`, 'gi');\n\n        return escaped.replace(regex, '<mark>$1</mark>');\n    }\n\n    private base64DecodeUtf8(base64: string): string {\n        const binaryString = atob(base64);\n        const bytes = new Uint8Array(binaryString.length);\n        for (let i = 0; i < binaryString.length; i++) {\n            bytes[i] = binaryString.charCodeAt(i);\n        }\n        return new TextDecoder('utf-8').decode(bytes);\n    }\n\n    private base64EncodeUtf8(str: string): string {\n        const bytes = new TextEncoder().encode(str);\n        let binaryString = '';\n        for (let i = 0; i < bytes.length; i++) {\n            binaryString += String.fromCharCode(bytes[i]);\n        }\n        return btoa(binaryString);\n    }\n\n    private async saveBackup(): Promise<void> {\n        if (!this.data) return;\n\n        try {\n            this.data.dayEntries = this.entries;\n\n            const jsonString = JSON.stringify(this.data);\n            const base64Content = this.base64EncodeUtf8(jsonString);\n\n            const zip = new JSZip();\n            zip.file('backup.daylio', base64Content);\n\n            for (const [path, content] of Object.entries(this.assets)) {\n                zip.file(path, content);\n            }\n\n            const blob = await zip.generateAsync({\n                type: 'blob',\n                compression: 'STORE'\n            });\n\n            const url = URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.href = url;\n\n            const now = new Date();\n            const dateStr = `${now.getFullYear()}_${String(now.getMonth() + 1).padStart(2, '0')}_${String(now.getDate()).padStart(2, '0')}`;\n            a.download = `backup_${dateStr}.daylio`;\n\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n\n            this.clearUnsavedChanges();\n            this.showToast('success', 'Backup Downloaded', 'Your modified backup is ready to import into Daylio.');\n        } catch (err) {\n            this.showToast('error', 'Failed to Save Backup', (err as Error).message);\n        }\n    }\n\n    private exportCsv(): void {\n        try {\n            if (!this.entries || this.entries.length === 0) {\n                this.showToast('warning', 'No Entries', 'Load a backup file first before exporting.');\n                return;\n            }\n\n            const headers = ['Date', 'Weekday', 'Time', 'Mood', 'Title', 'Note'];\n            const rows: string[][] = [headers];\n\n            const weekdays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n\n            const sortedEntries = [...this.entries].sort((a, b) => {\n                const dateA = new Date(a.year, a.month, a.day, a.hour, a.minute);\n                const dateB = new Date(b.year, b.month, b.day, b.hour, b.minute);\n                return dateA.getTime() - dateB.getTime();\n            });\n\n            for (const entry of sortedEntries) {\n                const date = `${entry.year}-${String(entry.month + 1).padStart(2, '0')}-${String(entry.day).padStart(2, '0')}`;\n                const weekday = weekdays[new Date(entry.year, entry.month, entry.day).getDay()];\n                const time = `${String(entry.hour).padStart(2, '0')}:${String(entry.minute).padStart(2, '0')}`;\n                const mood = this.getMoodLabel(entry.mood);\n                const title = entry.note_title || '';\n                const note = this.htmlToPlainText(entry.note || '');\n\n                rows.push([date, weekday, time, mood, title, note]);\n            }\n\n            const csv = rows.map(row =>\n                row.map(cell => this.escapeCsvField(cell)).join(',')\n            ).join('\\n');\n\n            const bom = '\\uFEFF';\n            const blob = new Blob([bom + csv], { type: 'text/csv;charset=utf-8' });\n\n            const url = URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.href = url;\n\n            const now = new Date();\n            const dateStr = `${now.getFullYear()}_${String(now.getMonth() + 1).padStart(2, '0')}_${String(now.getDate()).padStart(2, '0')}`;\n            a.download = `daylio_export_${dateStr}.csv`;\n\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n\n            this.showToast('success', 'CSV Exported', `Exported ${this.entries.length} entries to CSV.`);\n        } catch (err) {\n            this.showToast('error', 'Failed to Export CSV', (err as Error).message);\n            console.error('CSV export error:', err);\n        }\n    }\n\n    private escapeCsvField(field: unknown): string {\n        if (field === null || field === undefined) return '';\n\n        const str = String(field);\n\n        if (str.includes(',') || str.includes('\"') || str.includes('\\n') || str.includes('\\r')) {\n            return '\"' + str.replace(/\"/g, '\"\"') + '\"';\n        }\n\n        return str;\n    }\n}\n\n// Initialize the app\ndocument.addEventListener('DOMContentLoaded', () => {\n    new DaylioScribe();\n});\n"],
  "mappings": "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",
  "names": ["a"]
}
